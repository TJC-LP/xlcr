package build.`core-aspose`

import mill._
import mill.scalalib._

object `package` extends Cross[CoreAsposeModule](Seq("3.3.4"))

trait CoreAsposeModule extends build.XLCRModule {
  override def artifactName = "xlcr-core-aspose"
  override def artifactDescription =
    "XLCR Aspose - Aspose-based document conversion bridges"

  override def moduleDeps = Seq(build.core("3.3.4"))

  // Test source directories
  def testSources = Task.Sources(
    moduleDir / "test" / "src",
    moduleDir / "test" / "src-3"
  )

  // Disable Scala 3 doc generation due to Aspose term conflicts
  override def docSources: T[Seq[PathRef]] = Task {
    if (crossScalaVersion.startsWith("3.")) {
      Seq.empty[PathRef]
    } else {
      super.docSources()
    }
  }

  override def scalacOptions: T[Seq[String]] =
    super.scalacOptions() ++ Seq(
      "-Yresolve-term-conflict:package"
    )

  override def mvnDeps = Seq(
    mvn"com.aspose:aspose-cells:26.2",
    mvn"com.aspose:aspose-words:26.2;classifier=jdk17",
    mvn"com.aspose:aspose-slides:26.2;classifier=jdk16",
    mvn"com.aspose:aspose-email:26.1;classifier=jdk16",
    mvn"com.aspose:aspose-zip:26.1;classifier=jdk18",
    mvn"com.aspose:aspose-pdf:26.1",
    mvn"dev.zio::zio-blocks-scope:0.0.26"
  )

  object test extends ScalaTests with build.XLCRSerialTestModule {
    override def sources = testSources
  }
}
